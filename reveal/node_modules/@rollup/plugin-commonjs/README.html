
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>@rollup/plugin-commonjs &#8212; INF 133 Fall 2023</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../../_static/logo_stacked.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">INF 133 Fall 2023</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../index.html">
                    User Interaction Software
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Assignments
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../assignments/a0.html">
   Assignment 0
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../assignments/a1.html">
   Assignment 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../assignments/a2.html">
   Assignment 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../assignments/a3.html">
   Assignment 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../assignments/a4.html">
   Assignment 4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../assignments/a5.html">
   Assignment 5
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Weekly Notes
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../notes/wk1.html">
   Week 1 Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../notes/wk2.html">
   Week 2 Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../notes/wk3.html">
   Week 3 Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../notes/wk4.html">
   Week 4 Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../notes/wk5.html">
   Week 5 Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../notes/wk6.html">
   Week 6 Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../notes/wk7.html">
   Week 7 Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../notes/wk8.html">
   Week 8 Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../notes/wk9.html">
   Week 9 Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../notes/wk10.html">
   Week 10 Notes
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Course Resources
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../resources.html">
   Resources
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../../_sources/reveal/node_modules/@rollup/plugin-commonjs/README.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#requirements">
   Requirements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#install">
   Install
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#usage">
   Usage
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#options">
   Options
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#strictrequires">
     <code class="docutils literal notranslate">
      <span class="pre">
       strictRequires
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dynamicrequiretargets">
     <code class="docutils literal notranslate">
      <span class="pre">
       dynamicRequireTargets
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dynamicrequireroot">
     <code class="docutils literal notranslate">
      <span class="pre">
       dynamicRequireRoot
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exclude">
     <code class="docutils literal notranslate">
      <span class="pre">
       exclude
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#include">
     <code class="docutils literal notranslate">
      <span class="pre">
       include
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extensions">
     <code class="docutils literal notranslate">
      <span class="pre">
       extensions
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ignoreglobal">
     <code class="docutils literal notranslate">
      <span class="pre">
       ignoreGlobal
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sourcemap">
     <code class="docutils literal notranslate">
      <span class="pre">
       sourceMap
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#transformmixedesmodules">
     <code class="docutils literal notranslate">
      <span class="pre">
       transformMixedEsModules
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ignore">
     <code class="docutils literal notranslate">
      <span class="pre">
       ignore
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ignoretrycatch">
     <code class="docutils literal notranslate">
      <span class="pre">
       ignoreTryCatch
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ignoredynamicrequires">
     <code class="docutils literal notranslate">
      <span class="pre">
       ignoreDynamicRequires
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#esmexternals">
     <code class="docutils literal notranslate">
      <span class="pre">
       esmExternals
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#defaultismoduleexports">
     <code class="docutils literal notranslate">
      <span class="pre">
       defaultIsModuleExports
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#requirereturnsdefault">
     <code class="docutils literal notranslate">
      <span class="pre">
       requireReturnsDefault
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-with-rollup-plugin-node-resolve">
   Using with @rollup/plugin-node-resolve
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#usage-with-symlinks">
   Usage with symlinks
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#strict-mode">
   Strict mode
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#inter-plugin-communication">
   Inter-plugin-communication
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#meta">
   Meta
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>@rollup/plugin-commonjs</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#requirements">
   Requirements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#install">
   Install
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#usage">
   Usage
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#options">
   Options
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#strictrequires">
     <code class="docutils literal notranslate">
      <span class="pre">
       strictRequires
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dynamicrequiretargets">
     <code class="docutils literal notranslate">
      <span class="pre">
       dynamicRequireTargets
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dynamicrequireroot">
     <code class="docutils literal notranslate">
      <span class="pre">
       dynamicRequireRoot
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exclude">
     <code class="docutils literal notranslate">
      <span class="pre">
       exclude
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#include">
     <code class="docutils literal notranslate">
      <span class="pre">
       include
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extensions">
     <code class="docutils literal notranslate">
      <span class="pre">
       extensions
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ignoreglobal">
     <code class="docutils literal notranslate">
      <span class="pre">
       ignoreGlobal
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sourcemap">
     <code class="docutils literal notranslate">
      <span class="pre">
       sourceMap
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#transformmixedesmodules">
     <code class="docutils literal notranslate">
      <span class="pre">
       transformMixedEsModules
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ignore">
     <code class="docutils literal notranslate">
      <span class="pre">
       ignore
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ignoretrycatch">
     <code class="docutils literal notranslate">
      <span class="pre">
       ignoreTryCatch
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ignoredynamicrequires">
     <code class="docutils literal notranslate">
      <span class="pre">
       ignoreDynamicRequires
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#esmexternals">
     <code class="docutils literal notranslate">
      <span class="pre">
       esmExternals
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#defaultismoduleexports">
     <code class="docutils literal notranslate">
      <span class="pre">
       defaultIsModuleExports
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#requirereturnsdefault">
     <code class="docutils literal notranslate">
      <span class="pre">
       requireReturnsDefault
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-with-rollup-plugin-node-resolve">
   Using with @rollup/plugin-node-resolve
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#usage-with-symlinks">
   Usage with symlinks
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#strict-mode">
   Strict mode
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#inter-plugin-communication">
   Inter-plugin-communication
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#meta">
   Meta
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <p><a class="reference external" href="https://www.npmjs.com/package/&#64;rollup/plugin-commonjs"><img alt="npm" src="https://img.shields.io/npm/v/&#64;rollup/plugin-commonjs" /></a>
<a class="reference external" href="https://packagephobia.now.sh/result?p=&#64;rollup/plugin-commonjs"><img alt="size" src="https://packagephobia.now.sh/badge?p=&#64;rollup/plugin-commonjs" /></a>
<a class="reference external" href="https://liberamanifesto.com"><img alt="libera manifesto" src="https://img.shields.io/badge/libera-manifesto-lightgrey.svg" /></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="rollup-plugin-commonjs">
<h1>&#64;rollup/plugin-commonjs<a class="headerlink" href="#rollup-plugin-commonjs" title="Permalink to this headline">#</a></h1>
<p>üç£ A Rollup plugin to convert CommonJS modules to ES6, so they can be included in a Rollup bundle</p>
<section id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">#</a></h2>
<p>This plugin requires an <a class="reference external" href="https://github.com/nodejs/Release">LTS</a> Node version (v14.0.0+) and Rollup v2.68.0+. If you are using <a class="reference external" href="https://github.com/rollup/plugins/tree/master/packages/node-resolve"><code class="docutils literal notranslate"><span class="pre">&#64;rollup/plugin-node-resolve</span></code></a>, it should be v13.0.6+.</p>
</section>
<section id="install">
<h2>Install<a class="headerlink" href="#install" title="Permalink to this headline">#</a></h2>
<p>Using npm:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>npm<span class="w"> </span>install<span class="w"> </span>@rollup/plugin-commonjs<span class="w"> </span>--save-dev
</pre></div>
</div>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">#</a></h2>
<p>Create a <code class="docutils literal notranslate"><span class="pre">rollup.config.js</span></code> <a class="reference external" href="https://www.rollupjs.org/guide/en/#configuration-files">configuration file</a> and import the plugin:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nx">commonjs</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@rollup/plugin-commonjs&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">input</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;src/index.js&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">output</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">dir</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;output&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">format</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;cjs&#39;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nx">plugins</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">commonjs</span><span class="p">()]</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Then call <code class="docutils literal notranslate"><span class="pre">rollup</span></code> either via the <a class="reference external" href="https://www.rollupjs.org/guide/en/#command-line-reference">CLI</a> or the <a class="reference external" href="https://www.rollupjs.org/guide/en/#javascript-api">API</a>.</p>
<p>When used together with the node-resolve plugin</p>
</section>
<section id="options">
<h2>Options<a class="headerlink" href="#options" title="Permalink to this headline">#</a></h2>
<section id="strictrequires">
<h3><code class="docutils literal notranslate"><span class="pre">strictRequires</span></code><a class="headerlink" href="#strictrequires" title="Permalink to this headline">#</a></h3>
<p>Type: <code class="docutils literal notranslate"><span class="pre">&quot;auto&quot;</span> <span class="pre">|</span> <span class="pre">boolean</span> <span class="pre">|</span> <span class="pre">&quot;debug&quot;</span> <span class="pre">|</span> <span class="pre">string[]</span></code><br>
Default: <code class="docutils literal notranslate"><span class="pre">&quot;auto&quot;</span></code></p>
<p>By default, this plugin will try to hoist <code class="docutils literal notranslate"><span class="pre">require</span></code> statements as imports to the top of each file. While this works well for many code bases and allows for very efficient ESM output, it does not perfectly capture CommonJS semantics as the initialisation order of required modules will be different. The resultant side effects can include log statements being emitted in a different order, and some code that is dependent on the initialisation order of polyfills in require statements may not work. But it is especially problematic when there are circular <code class="docutils literal notranslate"><span class="pre">require</span></code> calls between CommonJS modules as those often rely on the lazy execution of nested <code class="docutils literal notranslate"><span class="pre">require</span></code> calls.</p>
<p>Setting this option to <code class="docutils literal notranslate"><span class="pre">true</span></code> will wrap all CommonJS files in functions which are executed when they are required for the first time, preserving NodeJS semantics. This is the safest setting and should be used if the generated code does not work correctly with <code class="docutils literal notranslate"><span class="pre">&quot;auto&quot;</span></code>. Note that <code class="docutils literal notranslate"><span class="pre">strictRequires:</span> <span class="pre">true</span></code> can have a small impact on the size and performance of generated code, but less so if the code is minified.</p>
<p>The default value of <code class="docutils literal notranslate"><span class="pre">&quot;auto&quot;</span></code> will only wrap CommonJS files when they are part of a CommonJS dependency cycle, e.g. an index file that is required by some of its dependencies, or if they are only required in a potentially ‚Äúconditional‚Äù way like from within an if-statement or a function. All other CommonJS files are hoisted. This is the recommended setting for most code bases. Note that the detection of conditional requires can be subject to race conditions if there are both conditional and unconditional requires of the same file, which in edge cases may result in inconsistencies between builds. If you think this is a problem for you, you can avoid this by using any value other than <code class="docutils literal notranslate"><span class="pre">&quot;auto&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;debug&quot;</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">false</span></code> will entirely prevent wrapping and hoist all files. This may still work depending on the nature of cyclic dependencies but will often cause problems.</p>
<p>You can also provide a <a class="reference external" href="https://github.com/micromatch/picomatch">picomatch pattern</a>, or array of patterns, to only specify a subset of files which should be wrapped in functions for proper <code class="docutils literal notranslate"><span class="pre">require</span></code> semantics.</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;debug&quot;</span></code> works like <code class="docutils literal notranslate"><span class="pre">&quot;auto&quot;</span></code> but after bundling, it will display a warning containing a list of ids that have been wrapped which can be used as picomatch pattern for fine-tuning or to avoid the potential race conditions mentioned for <code class="docutils literal notranslate"><span class="pre">&quot;auto&quot;</span></code>.</p>
</section>
<section id="dynamicrequiretargets">
<h3><code class="docutils literal notranslate"><span class="pre">dynamicRequireTargets</span></code><a class="headerlink" href="#dynamicrequiretargets" title="Permalink to this headline">#</a></h3>
<p>Type: <code class="docutils literal notranslate"><span class="pre">string</span> <span class="pre">|</span> <span class="pre">string[]</span></code><br>
Default: <code class="docutils literal notranslate"><span class="pre">[]</span></code></p>
<p><em>Note: In previous versions, this option would spin up a rather comprehensive mock environment that was capable of handling modules that manipulate <code class="docutils literal notranslate"><span class="pre">require.cache</span></code>. This is no longer supported. If you rely on this e.g. when using request-promise-native, use version 21 of this plugin.</em></p>
<p>Some modules contain dynamic <code class="docutils literal notranslate"><span class="pre">require</span></code> calls, or require modules that contain circular dependencies, which are not handled well by static imports.
Including those modules as <code class="docutils literal notranslate"><span class="pre">dynamicRequireTargets</span></code> will simulate a CommonJS (NodeJS-like) environment for them with support for dynamic dependencies. It also enables <code class="docutils literal notranslate"><span class="pre">strictRequires</span></code> for those modules, see above.</p>
<p><em>Note: In extreme cases, this feature may result in some paths being rendered as absolute in the final bundle. The plugin tries to avoid exposing paths from the local machine, but if you are <code class="docutils literal notranslate"><span class="pre">dynamicRequirePaths</span></code> with paths that are far away from your project‚Äôs folder, that may require replacing strings like <code class="docutils literal notranslate"><span class="pre">&quot;/Users/John/Desktop/foo-project/&quot;</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">&quot;/&quot;</span></code>.</em></p>
<p>Example:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">commonjs</span><span class="p">({</span>
<span class="w">  </span><span class="nx">dynamicRequireTargets</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="c1">// include using a glob pattern (either a string or an array of strings)</span>
<span class="w">    </span><span class="s1">&#39;node_modules/logform/*.js&#39;</span><span class="p">,</span>

<span class="w">    </span><span class="c1">// exclude files that are known to not be required dynamically, this allows for better optimizations</span>
<span class="w">    </span><span class="s1">&#39;!node_modules/logform/index.js&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="s1">&#39;!node_modules/logform/format.js&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="s1">&#39;!node_modules/logform/levels.js&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="s1">&#39;!node_modules/logform/browser.js&#39;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">});</span>
</pre></div>
</div>
</section>
<section id="dynamicrequireroot">
<h3><code class="docutils literal notranslate"><span class="pre">dynamicRequireRoot</span></code><a class="headerlink" href="#dynamicrequireroot" title="Permalink to this headline">#</a></h3>
<p>Type: <code class="docutils literal notranslate"><span class="pre">string</span></code><br>
Default: <code class="docutils literal notranslate"><span class="pre">process.cwd()</span></code></p>
<p>To avoid long paths when using the <code class="docutils literal notranslate"><span class="pre">dynamicRequireTargets</span></code> option, you can use this option to specify a directory that is a common parent for all files that use dynamic require statements. Using a directory higher up such as <code class="docutils literal notranslate"><span class="pre">/</span></code> may lead to unnecessarily long paths in the generated code and may expose directory names on your machine like your home directory name. By default it uses the current working directory.</p>
</section>
<section id="exclude">
<h3><code class="docutils literal notranslate"><span class="pre">exclude</span></code><a class="headerlink" href="#exclude" title="Permalink to this headline">#</a></h3>
<p>Type: <code class="docutils literal notranslate"><span class="pre">string</span> <span class="pre">|</span> <span class="pre">string[]</span></code><br>
Default: <code class="docutils literal notranslate"><span class="pre">null</span></code></p>
<p>A <a class="reference external" href="https://github.com/micromatch/picomatch">picomatch pattern</a>, or array of patterns, which specifies the files in the build the plugin should <em>ignore</em>. By default, all files with extensions other than those in <code class="docutils literal notranslate"><span class="pre">extensions</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;.cjs&quot;</span></code> are ignored, but you can exclude additional files. See also the <code class="docutils literal notranslate"><span class="pre">include</span></code> option.</p>
</section>
<section id="include">
<h3><code class="docutils literal notranslate"><span class="pre">include</span></code><a class="headerlink" href="#include" title="Permalink to this headline">#</a></h3>
<p>Type: <code class="docutils literal notranslate"><span class="pre">string</span> <span class="pre">|</span> <span class="pre">string[]</span></code><br>
Default: <code class="docutils literal notranslate"><span class="pre">null</span></code></p>
<p>A <a class="reference external" href="https://github.com/micromatch/picomatch">picomatch pattern</a>, or array of patterns, which specifies the files in the build the plugin should operate on. By default, all files with extension <code class="docutils literal notranslate"><span class="pre">&quot;.cjs&quot;</span></code> or those in <code class="docutils literal notranslate"><span class="pre">extensions</span></code> are included, but you can narrow this list by only including specific files. These files will be analyzed and transpiled if either the analysis does not find ES module specific statements or <code class="docutils literal notranslate"><span class="pre">transformMixedEsModules</span></code> is <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
</section>
<section id="extensions">
<h3><code class="docutils literal notranslate"><span class="pre">extensions</span></code><a class="headerlink" href="#extensions" title="Permalink to this headline">#</a></h3>
<p>Type: <code class="docutils literal notranslate"><span class="pre">string[]</span></code><br>
Default: <code class="docutils literal notranslate"><span class="pre">['.js']</span></code></p>
<p>For extensionless imports, search for extensions other than .js in the order specified. Note that you need to make sure that non-JavaScript files are transpiled by another plugin first.</p>
</section>
<section id="ignoreglobal">
<h3><code class="docutils literal notranslate"><span class="pre">ignoreGlobal</span></code><a class="headerlink" href="#ignoreglobal" title="Permalink to this headline">#</a></h3>
<p>Type: <code class="docutils literal notranslate"><span class="pre">boolean</span></code><br>
Default: <code class="docutils literal notranslate"><span class="pre">false</span></code></p>
<p>If true, uses of <code class="docutils literal notranslate"><span class="pre">global</span></code> won‚Äôt be dealt with by this plugin.</p>
</section>
<section id="sourcemap">
<h3><code class="docutils literal notranslate"><span class="pre">sourceMap</span></code><a class="headerlink" href="#sourcemap" title="Permalink to this headline">#</a></h3>
<p>Type: <code class="docutils literal notranslate"><span class="pre">boolean</span></code><br>
Default: <code class="docutils literal notranslate"><span class="pre">true</span></code></p>
<p>If false, skips source map generation for CommonJS modules. This will improve performance.</p>
</section>
<section id="transformmixedesmodules">
<h3><code class="docutils literal notranslate"><span class="pre">transformMixedEsModules</span></code><a class="headerlink" href="#transformmixedesmodules" title="Permalink to this headline">#</a></h3>
<p>Type: <code class="docutils literal notranslate"><span class="pre">boolean</span></code><br>
Default: <code class="docutils literal notranslate"><span class="pre">false</span></code></p>
<p>Instructs the plugin whether to enable mixed module transformations. This is useful in scenarios with modules that contain a mix of ES <code class="docutils literal notranslate"><span class="pre">import</span></code> statements and CommonJS <code class="docutils literal notranslate"><span class="pre">require</span></code> expressions. Set to <code class="docutils literal notranslate"><span class="pre">true</span></code> if <code class="docutils literal notranslate"><span class="pre">require</span></code> calls should be transformed to imports in mixed modules, or <code class="docutils literal notranslate"><span class="pre">false</span></code> if the <code class="docutils literal notranslate"><span class="pre">require</span></code> expressions should survive the transformation. The latter can be important if the code contains environment detection, or you are coding for an environment with special treatment for <code class="docutils literal notranslate"><span class="pre">require</span></code> calls such as <a class="reference external" href="https://www.electronjs.org/">ElectronJS</a>. See also the ‚Äúignore‚Äù option.</p>
</section>
<section id="ignore">
<h3><code class="docutils literal notranslate"><span class="pre">ignore</span></code><a class="headerlink" href="#ignore" title="Permalink to this headline">#</a></h3>
<p>Type: <code class="docutils literal notranslate"><span class="pre">string[]</span> <span class="pre">|</span> <span class="pre">((id:</span> <span class="pre">string)</span> <span class="pre">=&gt;</span> <span class="pre">boolean)</span></code><br>
Default: <code class="docutils literal notranslate"><span class="pre">[]</span></code></p>
<p>Sometimes you have to leave require statements unconverted. Pass an array containing the IDs or an <code class="docutils literal notranslate"><span class="pre">id</span> <span class="pre">=&gt;</span> <span class="pre">boolean</span></code> function.</p>
</section>
<section id="ignoretrycatch">
<h3><code class="docutils literal notranslate"><span class="pre">ignoreTryCatch</span></code><a class="headerlink" href="#ignoretrycatch" title="Permalink to this headline">#</a></h3>
<p>Type: <code class="docutils literal notranslate"><span class="pre">boolean</span> <span class="pre">|</span> <span class="pre">'remove'</span> <span class="pre">|</span> <span class="pre">string[]</span> <span class="pre">|</span> <span class="pre">((id:</span> <span class="pre">string)</span> <span class="pre">=&gt;</span> <span class="pre">boolean)</span></code><br>
Default: <code class="docutils literal notranslate"><span class="pre">true</span></code></p>
<p>In most cases, where <code class="docutils literal notranslate"><span class="pre">require</span></code> calls to external dependencies are inside a <code class="docutils literal notranslate"><span class="pre">try-catch</span></code> clause, they should be left unconverted as it requires an optional dependency that may or may not be installed beside the rolled up package.
Due to the conversion of <code class="docutils literal notranslate"><span class="pre">require</span></code> to a static <code class="docutils literal notranslate"><span class="pre">import</span></code> - the call is hoisted to the top of the file, outside of the <code class="docutils literal notranslate"><span class="pre">try-catch</span></code> clause.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">true</span></code>: All external <code class="docutils literal notranslate"><span class="pre">require</span></code> calls inside a <code class="docutils literal notranslate"><span class="pre">try</span></code> will be left unconverted.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">false</span></code>: All external <code class="docutils literal notranslate"><span class="pre">require</span></code> calls inside a <code class="docutils literal notranslate"><span class="pre">try</span></code> will be converted as if the <code class="docutils literal notranslate"><span class="pre">try-catch</span></code> clause is not there.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">remove</span></code>: Remove all external <code class="docutils literal notranslate"><span class="pre">require</span></code> calls from inside any <code class="docutils literal notranslate"><span class="pre">try</span></code> block.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">string[]</span></code>: Pass an array containing the IDs to left unconverted.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">((id:</span> <span class="pre">string)</span> <span class="pre">=&gt;</span> <span class="pre">boolean|'remove')</span></code>: Pass a function that control individual IDs.</p></li>
</ul>
<p>Note that non-external requires will not be ignored by this option.</p>
</section>
<section id="ignoredynamicrequires">
<h3><code class="docutils literal notranslate"><span class="pre">ignoreDynamicRequires</span></code><a class="headerlink" href="#ignoredynamicrequires" title="Permalink to this headline">#</a></h3>
<p>Type: <code class="docutils literal notranslate"><span class="pre">boolean</span></code>
Default: false</p>
<p>Some <code class="docutils literal notranslate"><span class="pre">require</span></code> calls cannot be resolved statically to be translated to imports, e.g.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="nx">wrappedRequire</span><span class="p">(</span><span class="nx">target</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="nx">target</span><span class="p">);</span>
<span class="p">}</span>
<span class="nx">wrappedRequire</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">);</span>
<span class="nx">wrappedRequire</span><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>When this option is set to <code class="docutils literal notranslate"><span class="pre">false</span></code>, the generated code will either directly throw an error when such a call is encountered or, when <code class="docutils literal notranslate"><span class="pre">dynamicRequireTargets</span></code> is used, when such a call cannot be resolved with a configured dynamic require target.</p>
<p>Setting this option to <code class="docutils literal notranslate"><span class="pre">true</span></code> will instead leave the <code class="docutils literal notranslate"><span class="pre">require</span></code> call in the code or use it as a fallback for <code class="docutils literal notranslate"><span class="pre">dynamicRequireTargets</span></code>.</p>
</section>
<section id="esmexternals">
<h3><code class="docutils literal notranslate"><span class="pre">esmExternals</span></code><a class="headerlink" href="#esmexternals" title="Permalink to this headline">#</a></h3>
<p>Type: <code class="docutils literal notranslate"><span class="pre">boolean</span> <span class="pre">|</span> <span class="pre">string[]</span> <span class="pre">|</span> <span class="pre">((id:</span> <span class="pre">string)</span> <span class="pre">=&gt;</span> <span class="pre">boolean)</span></code>
Default: <code class="docutils literal notranslate"><span class="pre">false</span></code></p>
<p>Controls how to render imports from external dependencies. By default, this plugin assumes that all external dependencies are CommonJS. This means they are rendered as default imports to be compatible with e.g. NodeJS where ES modules can only import a default export from a CommonJS dependency:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// input</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">);</span>

<span class="c1">// output</span>
<span class="k">import</span><span class="w"> </span><span class="nx">foo</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;foo&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>This is likely not desired for ES module dependencies: Here <code class="docutils literal notranslate"><span class="pre">require</span></code> should usually return the namespace to be compatible with how bundled modules are handled.</p>
<p>If you set <code class="docutils literal notranslate"><span class="pre">esmExternals</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>, this plugins assumes that all external dependencies are ES modules and will adhere to the <code class="docutils literal notranslate"><span class="pre">requireReturnsDefault</span></code> option. If that option is not set, they will be rendered as namespace imports.</p>
<p>You can also supply an array of ids to be treated as ES modules, or a function that will be passed each external id to determine if it is an ES module.</p>
</section>
<section id="defaultismoduleexports">
<h3><code class="docutils literal notranslate"><span class="pre">defaultIsModuleExports</span></code><a class="headerlink" href="#defaultismoduleexports" title="Permalink to this headline">#</a></h3>
<p>Type: <code class="docutils literal notranslate"><span class="pre">boolean</span> <span class="pre">|</span> <span class="pre">&quot;auto&quot;</span></code><br>
Default: <code class="docutils literal notranslate"><span class="pre">&quot;auto&quot;</span></code></p>
<p>Controls what is the default export when importing a CommonJS file from an ES module.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">true</span></code>: The value of the default export is <code class="docutils literal notranslate"><span class="pre">module.exports</span></code>. This currently matches the behavior of Node.js when importing a CommonJS file.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// mod.cjs</span>
<span class="nx">exports</span><span class="p">.</span><span class="k">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nx">foo</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./mod.cjs&#39;</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">foo</span><span class="p">);</span><span class="w"> </span><span class="c1">// { default: 3 }</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">false</span></code>: The value of the default export is <code class="docutils literal notranslate"><span class="pre">exports.default</span></code>.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// mod.cjs</span>
<span class="nx">exports</span><span class="p">.</span><span class="k">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nx">foo</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./mod.cjs&#39;</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">foo</span><span class="p">);</span><span class="w"> </span><span class="c1">// 3</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;auto&quot;</span></code>: The value of the default export is <code class="docutils literal notranslate"><span class="pre">exports.default</span></code> if the CommonJS file has an <code class="docutils literal notranslate"><span class="pre">exports.__esModule</span> <span class="pre">===</span> <span class="pre">true</span></code> property; otherwise it‚Äôs <code class="docutils literal notranslate"><span class="pre">module.exports</span></code>. This makes it possible to import
the default export of ES modules compiled to CommonJS as if they were not compiled.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// mod.cjs</span>
<span class="nx">exports</span><span class="p">.</span><span class="k">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// mod-compiled.cjs</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">__esModule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="nx">exports</span><span class="p">.</span><span class="k">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nx">foo</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./mod.cjs&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="nx">bar</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./mod-compiled.cjs&#39;</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">foo</span><span class="p">);</span><span class="w"> </span><span class="c1">// { default: 3 }</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">bar</span><span class="p">);</span><span class="w"> </span><span class="c1">// 3</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="requirereturnsdefault">
<h3><code class="docutils literal notranslate"><span class="pre">requireReturnsDefault</span></code><a class="headerlink" href="#requirereturnsdefault" title="Permalink to this headline">#</a></h3>
<p>Type: <code class="docutils literal notranslate"><span class="pre">boolean</span> <span class="pre">|</span> <span class="pre">&quot;namespace&quot;</span> <span class="pre">|</span> <span class="pre">&quot;auto&quot;</span> <span class="pre">|</span> <span class="pre">&quot;preferred&quot;</span> <span class="pre">|</span> <span class="pre">((id:</span> <span class="pre">string)</span> <span class="pre">=&gt;</span> <span class="pre">boolean</span> <span class="pre">|</span> <span class="pre">&quot;auto&quot;</span> <span class="pre">|</span> <span class="pre">&quot;preferred&quot;)</span></code><br>
Default: <code class="docutils literal notranslate"><span class="pre">false</span></code></p>
<p>Controls what is returned when requiring an ES module from a CommonJS file. When using the <code class="docutils literal notranslate"><span class="pre">esmExternals</span></code> option, this will also apply to external modules. By default, this plugin will render those imports as namespace imports, i.e.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// input</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">);</span>

<span class="c1">// output</span>
<span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">foo</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;foo&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>This is in line with how other bundlers handle this situation and is also the most likely behaviour in case Node should ever support this. However there are some situations where this may not be desired:</p>
<ul>
<li><p>There is code in an external dependency that cannot be changed where a <code class="docutils literal notranslate"><span class="pre">require</span></code> statement expects the default export to be returned from an ES module.</p></li>
<li><p>If the imported module is in the same bundle, Rollup will generate a namespace object for the imported module which can increase bundle size unnecessarily:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// input: main.js</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">dep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./dep.js&#39;</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">dep</span><span class="p">.</span><span class="k">default</span><span class="p">);</span>

<span class="c1">// input: dep.js</span>
<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;foo&#39;</span><span class="p">;</span>

<span class="c1">// output</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">dep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;foo&#39;</span><span class="p">;</span>

<span class="kd">var</span><span class="w"> </span><span class="nx">dep$1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="cm">/*#__PURE__*/</span><span class="w"> </span><span class="nb">Object</span><span class="p">.</span><span class="nx">freeze</span><span class="p">({</span>
<span class="w">  </span><span class="nx">__proto__</span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="nx">dep</span>
<span class="p">});</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">dep$1</span><span class="p">.</span><span class="k">default</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ul>
<p>For these situations, you can change Rollup‚Äôs behaviour either globally or per module. To change it globally, set the <code class="docutils literal notranslate"><span class="pre">requireReturnsDefault</span></code> option to one of the following values:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">false</span></code>: This is the default, requiring an ES module returns its namespace. This is the only option that will also add a marker <code class="docutils literal notranslate"><span class="pre">__esModule:</span> <span class="pre">true</span></code> to the namespace to support interop patterns in CommonJS modules that are transpiled ES modules.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// input</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">dep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;dep&#39;</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">dep</span><span class="p">);</span>

<span class="c1">// output</span>
<span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">dep$1</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;dep&#39;</span><span class="p">;</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">getAugmentedNamespace</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">n</span><span class="p">.</span><span class="nx">__esModule</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">n</span><span class="p">;</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">n</span><span class="p">.</span><span class="k">default</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">f</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;function&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">a</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="nx">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">Reflect</span><span class="p">.</span><span class="nx">construct</span><span class="p">(</span><span class="nx">f</span><span class="p">,</span><span class="w"> </span><span class="nx">arguments</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="kr">constructor</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">f</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="nx">arguments</span><span class="p">);</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="nx">a</span><span class="p">.</span><span class="nx">prototype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">f</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="w">  </span><span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;__esModule&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">n</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">k</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Object</span><span class="p">.</span><span class="nx">getOwnPropertyDescriptor</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span><span class="w"> </span><span class="nx">k</span><span class="p">);</span>
<span class="w">    </span><span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span>
<span class="w">      </span><span class="nx">a</span><span class="p">,</span>
<span class="w">      </span><span class="nx">k</span><span class="p">,</span>
<span class="w">      </span><span class="nx">d</span><span class="p">.</span><span class="nx">get</span>
<span class="w">        </span><span class="o">?</span><span class="w"> </span><span class="nx">d</span>
<span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">enumerable</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">            </span><span class="nx">get</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="k">return</span><span class="w"> </span><span class="nx">n</span><span class="p">[</span><span class="nx">k</span><span class="p">];</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">});</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">a</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">var</span><span class="w"> </span><span class="nx">dep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="cm">/*@__PURE__*/</span><span class="w"> </span><span class="nx">getAugmentedNamespace</span><span class="p">(</span><span class="nx">dep$1</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">dep</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;namespace&quot;</span></code>: Like <code class="docutils literal notranslate"><span class="pre">false</span></code>, requiring an ES module returns its namespace, but the plugin does not add the <code class="docutils literal notranslate"><span class="pre">__esModule</span></code> marker and thus creates more efficient code. For external dependencies when using <code class="docutils literal notranslate"><span class="pre">esmExternals:</span> <span class="pre">true</span></code>, no additional interop code is generated.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// output</span>
<span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">dep</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;dep&#39;</span><span class="p">;</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">dep</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;auto&quot;</span></code>: This is complementary to how <a class="reference external" href="https://rollupjs.org/guide/en/#outputexports"><code class="docutils literal notranslate"><span class="pre">output.exports</span></code></a>: <code class="docutils literal notranslate"><span class="pre">&quot;auto&quot;</span></code> works in Rollup: If a module has a default export and no named exports, requiring that module returns the default export. In all other cases, the namespace is returned. For external dependencies when using <code class="docutils literal notranslate"><span class="pre">esmExternals:</span> <span class="pre">true</span></code>, a corresponding interop helper is added:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// output</span>
<span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">dep$1</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;dep&#39;</span><span class="p">;</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">getDefaultExportFromNamespaceIfNotNamed</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;default&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">n</span><span class="p">).</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span>
<span class="w">    </span><span class="o">?</span><span class="w"> </span><span class="nx">n</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span>
<span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="nx">n</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">var</span><span class="w"> </span><span class="nx">dep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">getDefaultExportFromNamespaceIfNotNamed</span><span class="p">(</span><span class="nx">dep$1</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">dep</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;preferred&quot;</span></code>: If a module has a default export, requiring that module always returns the default export, no matter whether additional named exports exist. This is similar to how previous versions of this plugin worked. Again for external dependencies when using <code class="docutils literal notranslate"><span class="pre">esmExternals:</span> <span class="pre">true</span></code>, an interop helper is added:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// output</span>
<span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">dep$1</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;dep&#39;</span><span class="p">;</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">getDefaultExportFromNamespaceIfPresent</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;default&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">n</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">n</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">var</span><span class="w"> </span><span class="nx">dep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">getDefaultExportFromNamespaceIfPresent</span><span class="p">(</span><span class="nx">dep$1</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">dep</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">true</span></code>: This will always try to return the default export on require without checking if it actually exists. This can throw at build time if there is no default export. This is how external dependencies are handled when <code class="docutils literal notranslate"><span class="pre">esmExternals</span></code> is not used. The advantage over the other options is that, like <code class="docutils literal notranslate"><span class="pre">false</span></code>, this does not add an interop helper for external dependencies, keeping the code lean:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// output</span>
<span class="k">import</span><span class="w"> </span><span class="nx">dep</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;dep&#39;</span><span class="p">;</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">dep</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ul>
<p>To change this for individual modules, you can supply a function for <code class="docutils literal notranslate"><span class="pre">requireReturnsDefault</span></code> instead. This function will then be called once for each required ES module or external dependency with the corresponding id and allows you to return different values for different modules.</p>
</section>
</section>
<section id="using-with-rollup-plugin-node-resolve">
<h2>Using with &#64;rollup/plugin-node-resolve<a class="headerlink" href="#using-with-rollup-plugin-node-resolve" title="Permalink to this headline">#</a></h2>
<p>Since most CommonJS packages you are importing are probably dependencies in <code class="docutils literal notranslate"><span class="pre">node_modules</span></code>, you may need to use <a class="reference external" href="https://github.com/rollup/plugins/tree/master/packages/node-resolve">&#64;rollup/plugin-node-resolve</a>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// rollup.config.js</span>
<span class="k">import</span><span class="w"> </span><span class="nx">resolve</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@rollup/plugin-node-resolve&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="nx">commonjs</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@rollup/plugin-commonjs&#39;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">input</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;main.js&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">output</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">file</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;bundle.js&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">format</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;iife&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;MyModule&#39;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nx">plugins</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">commonjs</span><span class="p">(),</span><span class="w"> </span><span class="nx">resolve</span><span class="p">()]</span>
<span class="p">};</span>
</pre></div>
</div>
</section>
<section id="usage-with-symlinks">
<h2>Usage with symlinks<a class="headerlink" href="#usage-with-symlinks" title="Permalink to this headline">#</a></h2>
<p>Symlinks are common in monorepos and are also created by the <code class="docutils literal notranslate"><span class="pre">npm</span> <span class="pre">link</span></code> command. Rollup with <code class="docutils literal notranslate"><span class="pre">&#64;rollup/plugin-node-resolve</span></code> resolves modules to their real paths by default. So <code class="docutils literal notranslate"><span class="pre">include</span></code> and <code class="docutils literal notranslate"><span class="pre">exclude</span></code> paths should handle real paths rather than symlinked paths (e.g. <code class="docutils literal notranslate"><span class="pre">../common/node_modules/**</span></code> instead of <code class="docutils literal notranslate"><span class="pre">node_modules/**</span></code>). You may also use a regular expression for <code class="docutils literal notranslate"><span class="pre">include</span></code> that works regardless of base path. Try this:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">commonjs</span><span class="p">({</span>
<span class="w">  </span><span class="nx">include</span><span class="o">:</span><span class="w"> </span><span class="sr">/node_modules/</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Whether symlinked module paths are <a class="reference external" href="http://man7.org/linux/man-pages/man3/realpath.3.html">realpathed</a> or preserved depends on Rollup‚Äôs <code class="docutils literal notranslate"><span class="pre">preserveSymlinks</span></code> setting, which is false by default, matching Node.js‚Äô default behavior. Setting <code class="docutils literal notranslate"><span class="pre">preserveSymlinks</span></code> to true in your Rollup config will cause <code class="docutils literal notranslate"><span class="pre">import</span></code> and <code class="docutils literal notranslate"><span class="pre">export</span></code> to match based on symlinked paths instead.</p>
</section>
<section id="strict-mode">
<h2>Strict mode<a class="headerlink" href="#strict-mode" title="Permalink to this headline">#</a></h2>
<p>ES modules are <em>always</em> parsed in strict mode. That means that certain non-strict constructs (like octal literals) will be treated as syntax errors when Rollup parses modules that use them. Some older CommonJS modules depend on those constructs, and if you depend on them your bundle will blow up. There‚Äôs basically nothing we can do about that.</p>
<p>Luckily, there is absolutely no good reason <em>not</em> to use strict mode for everything ‚Äî so the solution to this problem is to lobby the authors of those modules to update them.</p>
</section>
<section id="inter-plugin-communication">
<h2>Inter-plugin-communication<a class="headerlink" href="#inter-plugin-communication" title="Permalink to this headline">#</a></h2>
<p>This plugin exposes the result of its CommonJS file type detection for other plugins to use. You can access it via <code class="docutils literal notranslate"><span class="pre">this.getModuleInfo</span></code> or the <code class="docutils literal notranslate"><span class="pre">moduleParsed</span></code> hook:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="nx">cjsDetectionPlugin</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;cjs-detection&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">moduleParsed</span><span class="p">({</span>
<span class="w">      </span><span class="nx">id</span><span class="p">,</span>
<span class="w">      </span><span class="nx">meta</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">commonjs</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">isCommonJS</span><span class="w"> </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`File </span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb"> is CommonJS: </span><span class="si">${</span><span class="nx">isCommonJS</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="meta">
<h2>Meta<a class="headerlink" href="#meta" title="Permalink to this headline">#</a></h2>
<p><span class="xref myst">CONTRIBUTING</span></p>
<p><span class="xref myst">LICENSE (MIT)</span></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./reveal/node_modules/@rollup/plugin-commonjs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Mark S. Baldwin<br/>
  
      &copy; Copyright 2023.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>