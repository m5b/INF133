
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>magic-string &#8212; INF 133 Fall 2023</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/logo_stacked.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">INF 133 Fall 2023</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../index.html">
                    User Interaction Software
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Assignments
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/a0.html">
   Assignment 0
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/a1.html">
   Assignment 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/a2.html">
   Assignment 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/a3.html">
   Assignment 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/a4.html">
   Assignment 4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/a5.html">
   Assignment 5
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Weekly Notes
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../notes/wk1.html">
   Week 1 Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../notes/wk2.html">
   Week 2 Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../notes/wk3.html">
   Week 3 Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../notes/wk4.html">
   Week 4 Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../notes/wk5.html">
   Week 5 Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../notes/wk6.html">
   Week 6 Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../notes/wk7.html">
   Week 7 Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../notes/wk8.html">
   Week 8 Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../notes/wk9.html">
   Week 9 Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../notes/wk10.html">
   Week 10 Notes
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Course Resources
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../resources.html">
   Resources
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../_sources/reveal/node_modules/magic-string/README.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#installation">
   Installation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#usage">
   Usage
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#methods">
   Methods
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-addsourcemaplocation-index">
     s.addSourcemapLocation( index )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-append-content">
     s.append( content )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-appendleft-index-content">
     s.appendLeft( index, content )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-appendright-index-content">
     s.appendRight( index, content )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-clone">
     s.clone()
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-generatedecodedmap-options">
     s.generateDecodedMap( options )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-generatemap-options">
     s.generateMap( options )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-haschanged">
     s.hasChanged()
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-indent-prefix-options">
     s.indent( prefix[, options] )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-insertleft-index-content">
     s.insertLeft( index, content )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-insertright-index-content">
     s.insertRight( index, content )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-isempty">
     s.isEmpty()
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-locate-index">
     s.locate( index )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-locateorigin-index">
     s.locateOrigin( index )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-move-start-end-index">
     s.move( start, end, index )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-overwrite-start-end-content-options">
     s.overwrite( start, end, content[, options] )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-prepend-content">
     s.prepend( content )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-prependleft-index-content">
     s.prependLeft ( index, content )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-prependright-index-content">
     s.prependRight ( index, content )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-replace-regexporstring-substitution">
     s.replace( regexpOrString, substitution )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-replaceall-regexporstring-substitution">
     s.replaceAll( regexpOrString, substitution )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-remove-start-end">
     s.remove( start, end )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-slice-start-end">
     s.slice( start, end )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-snip-start-end">
     s.snip( start, end )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-tostring">
     s.toString()
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-trim-chartype">
     s.trim([ charType ])
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-trimstart-chartype">
     s.trimStart([ charType ])
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-trimend-chartype">
     s.trimEnd([ charType ])
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-trimlines">
     s.trimLines()
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-update-start-end-content-options">
     s.update( start, end, content[, options] )
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bundling">
   Bundling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#license">
   License
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>magic-string</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#installation">
   Installation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#usage">
   Usage
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#methods">
   Methods
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-addsourcemaplocation-index">
     s.addSourcemapLocation( index )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-append-content">
     s.append( content )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-appendleft-index-content">
     s.appendLeft( index, content )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-appendright-index-content">
     s.appendRight( index, content )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-clone">
     s.clone()
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-generatedecodedmap-options">
     s.generateDecodedMap( options )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-generatemap-options">
     s.generateMap( options )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-haschanged">
     s.hasChanged()
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-indent-prefix-options">
     s.indent( prefix[, options] )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-insertleft-index-content">
     s.insertLeft( index, content )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-insertright-index-content">
     s.insertRight( index, content )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-isempty">
     s.isEmpty()
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-locate-index">
     s.locate( index )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-locateorigin-index">
     s.locateOrigin( index )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-move-start-end-index">
     s.move( start, end, index )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-overwrite-start-end-content-options">
     s.overwrite( start, end, content[, options] )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-prepend-content">
     s.prepend( content )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-prependleft-index-content">
     s.prependLeft ( index, content )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-prependright-index-content">
     s.prependRight ( index, content )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-replace-regexporstring-substitution">
     s.replace( regexpOrString, substitution )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-replaceall-regexporstring-substitution">
     s.replaceAll( regexpOrString, substitution )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-remove-start-end">
     s.remove( start, end )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-slice-start-end">
     s.slice( start, end )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-snip-start-end">
     s.snip( start, end )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-tostring">
     s.toString()
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-trim-chartype">
     s.trim([ charType ])
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-trimstart-chartype">
     s.trimStart([ charType ])
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-trimend-chartype">
     s.trimEnd([ charType ])
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-trimlines">
     s.trimLines()
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s-update-start-end-content-options">
     s.update( start, end, content[, options] )
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bundling">
   Bundling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#license">
   License
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="magic-string">
<h1>magic-string<a class="headerlink" href="#magic-string" title="Permalink to this headline">#</a></h1>
<a href="https://travis-ci.org/Rich-Harris/magic-string">
  <img src="http://img.shields.io/travis/Rich-Harris/magic-string.svg"
       alt="build status">
</a>
<a href="https://npmjs.org/package/magic-string">
  <img src="https://img.shields.io/npm/v/magic-string.svg"
       alt="npm version">
</a>
<a href="https://github.com/Rich-Harris/magic-string/blob/master/LICENSE.md">
  <img src="https://img.shields.io/npm/l/magic-string.svg"
       alt="license">
</a>
<p>Suppose you have some source code. You want to make some light modifications to it - replacing a few characters here and there, wrapping it with a header and footer, etc - and ideally you’d like to generate a <a class="reference external" href="https://docs.google.com/document/d/1U1RGAehQwRypUTovF1KRlpiOFze0b-_2gc6fAH0KY0k/">source map</a> at the end of it. You’ve thought about using something like <a class="reference external" href="https://github.com/benjamn/recast">recast</a> (which allows you to generate an AST from some JavaScript, manipulate it, and reprint it with a sourcemap without losing your comments and formatting), but it seems like overkill for your needs (or maybe the source code isn’t JavaScript).</p>
<p>Your requirements are, frankly, rather niche. But they’re requirements that I also have, and for which I made magic-string. It’s a small, fast utility for manipulating strings and generating sourcemaps.</p>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">#</a></h2>
<p>magic-string works in both node.js and browser environments. For node, install with npm:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>npm<span class="w"> </span>i<span class="w"> </span>magic-string
</pre></div>
</div>
<p>To use in browser, grab the <a class="reference external" href="https://unpkg.com/magic-string/dist/magic-string.umd.js">magic-string.umd.js</a> file and add it to your page:</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#39;magic-string.umd.js&#39;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>(It also works with various module systems, if you prefer that sort of thing - it has a dependency on <a class="reference external" href="https://github.com/Rich-Harris/vlq">vlq</a>.)</p>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">#</a></h2>
<p>These examples assume you’re in node.js, or something similar:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nx">MagicString</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;magic-string&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="nx">fs</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;fs&#39;</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">MagicString</span><span class="p">(</span><span class="s1">&#39;problems = 99&#39;</span><span class="p">);</span>

<span class="nx">s</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">8</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;answer&#39;</span><span class="p">);</span>
<span class="nx">s</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span><span class="w"> </span><span class="c1">// &#39;answer = 99&#39;</span>

<span class="nx">s</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="mf">11</span><span class="p">,</span><span class="w"> </span><span class="mf">13</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;42&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// character indices always refer to the original string</span>
<span class="nx">s</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span><span class="w"> </span><span class="c1">// &#39;answer = 42&#39;</span>

<span class="nx">s</span><span class="p">.</span><span class="nx">prepend</span><span class="p">(</span><span class="s1">&#39;var &#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// most methods are chainable</span>
<span class="nx">s</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span><span class="w"> </span><span class="c1">// &#39;var answer = 42;&#39;</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">s</span><span class="p">.</span><span class="nx">generateMap</span><span class="p">({</span>
<span class="w">  </span><span class="nx">source</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;source.js&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">file</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;converted.js.map&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">includeContent</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">});</span><span class="w"> </span><span class="c1">// generates a v3 sourcemap</span>

<span class="nx">fs</span><span class="p">.</span><span class="nx">writeFileSync</span><span class="p">(</span><span class="s1">&#39;converted.js&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">s</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
<span class="nx">fs</span><span class="p">.</span><span class="nx">writeFileSync</span><span class="p">(</span><span class="s1">&#39;converted.js.map&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">map</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
</pre></div>
</div>
<p>You can pass an options argument:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">MagicString</span><span class="p">(</span><span class="nx">someCode</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// these options will be used if you later call `bundle.addSource( s )` - see below</span>
<span class="w">  </span><span class="nx">filename</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;foo.js&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">indentExclusionRanges</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="cm">/*...*/</span><span class="p">],</span>
<span class="w">  </span><span class="c1">// market source as ignore in DevTools, see below #Bundling</span>
<span class="w">  </span><span class="nx">ignoreList</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span>
<span class="p">});</span>
</pre></div>
</div>
</section>
<section id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Permalink to this headline">#</a></h2>
<section id="s-addsourcemaplocation-index">
<h3>s.addSourcemapLocation( index )<a class="headerlink" href="#s-addsourcemaplocation-index" title="Permalink to this headline">#</a></h3>
<p>Adds the specified character index (with respect to the original string) to sourcemap mappings, if <code class="docutils literal notranslate"><span class="pre">hires</span></code> is <code class="docutils literal notranslate"><span class="pre">false</span></code> (see below).</p>
</section>
<section id="s-append-content">
<h3>s.append( content )<a class="headerlink" href="#s-append-content" title="Permalink to this headline">#</a></h3>
<p>Appends the specified content to the end of the string. Returns <code class="docutils literal notranslate"><span class="pre">this</span></code>.</p>
</section>
<section id="s-appendleft-index-content">
<h3>s.appendLeft( index, content )<a class="headerlink" href="#s-appendleft-index-content" title="Permalink to this headline">#</a></h3>
<p>Appends the specified <code class="docutils literal notranslate"><span class="pre">content</span></code> at the <code class="docutils literal notranslate"><span class="pre">index</span></code> in the original string. If a range <em>ending</em> with <code class="docutils literal notranslate"><span class="pre">index</span></code> is subsequently moved, the insert will be moved with it. Returns <code class="docutils literal notranslate"><span class="pre">this</span></code>. See also <code class="docutils literal notranslate"><span class="pre">s.prependLeft(...)</span></code>.</p>
</section>
<section id="s-appendright-index-content">
<h3>s.appendRight( index, content )<a class="headerlink" href="#s-appendright-index-content" title="Permalink to this headline">#</a></h3>
<p>Appends the specified <code class="docutils literal notranslate"><span class="pre">content</span></code> at the <code class="docutils literal notranslate"><span class="pre">index</span></code> in the original string. If a range <em>starting</em> with <code class="docutils literal notranslate"><span class="pre">index</span></code> is subsequently moved, the insert will be moved with it. Returns <code class="docutils literal notranslate"><span class="pre">this</span></code>. See also <code class="docutils literal notranslate"><span class="pre">s.prependRight(...)</span></code>.</p>
</section>
<section id="s-clone">
<h3>s.clone()<a class="headerlink" href="#s-clone" title="Permalink to this headline">#</a></h3>
<p>Does what you’d expect.</p>
</section>
<section id="s-generatedecodedmap-options">
<h3>s.generateDecodedMap( options )<a class="headerlink" href="#s-generatedecodedmap-options" title="Permalink to this headline">#</a></h3>
<p>Generates a sourcemap object with raw mappings in array form, rather than encoded as a string. See <code class="docutils literal notranslate"><span class="pre">generateMap</span></code> documentation below for options details. Useful if you need to manipulate the sourcemap further, but most of the time you will use <code class="docutils literal notranslate"><span class="pre">generateMap</span></code> instead.</p>
</section>
<section id="s-generatemap-options">
<h3>s.generateMap( options )<a class="headerlink" href="#s-generatemap-options" title="Permalink to this headline">#</a></h3>
<p>Generates a <a class="reference external" href="https://docs.google.com/document/d/1U1RGAehQwRypUTovF1KRlpiOFze0b-_2gc6fAH0KY0k/edit">version 3 sourcemap</a>. All options are, well, optional:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">file</span></code> - the filename where you plan to write the sourcemap</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">source</span></code> - the filename of the file containing the original source</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">includeContent</span></code> - whether to include the original content in the map’s <code class="docutils literal notranslate"><span class="pre">sourcesContent</span></code> array</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hires</span></code> - whether the mapping should be high-resolution. Hi-res mappings map every single character, meaning (for example) your devtools will always be able to pinpoint the exact location of function calls and so on. With lo-res mappings, devtools may only be able to identify the correct line - but they’re quicker to generate and less bulky. You can also set <code class="docutils literal notranslate"><span class="pre">&quot;boundary&quot;</span></code> to generate a semi-hi-res mappings segmented per word boundary instead of per character, suitable for string semantics that are separated by words. If sourcemap locations have been specified with <code class="docutils literal notranslate"><span class="pre">s.addSourcemapLocation()</span></code>, they will be used here.</p></li>
</ul>
<p>The returned sourcemap has two (non-enumerable) methods attached for convenience:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">toString</span></code> - returns the equivalent of <code class="docutils literal notranslate"><span class="pre">JSON.stringify(map)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">toUrl</span></code> - returns a DataURI containing the sourcemap. Useful for doing this sort of thing:</p></li>
</ul>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">code</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;\n//# sourceMappingURL=&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">map</span><span class="p">.</span><span class="nx">toUrl</span><span class="p">();</span>
</pre></div>
</div>
</section>
<section id="s-haschanged">
<h3>s.hasChanged()<a class="headerlink" href="#s-haschanged" title="Permalink to this headline">#</a></h3>
<p>Indicates if the string has been changed.</p>
</section>
<section id="s-indent-prefix-options">
<h3>s.indent( prefix[, options] )<a class="headerlink" href="#s-indent-prefix-options" title="Permalink to this headline">#</a></h3>
<p>Prefixes each line of the string with <code class="docutils literal notranslate"><span class="pre">prefix</span></code>. If <code class="docutils literal notranslate"><span class="pre">prefix</span></code> is not supplied, the indentation will be guessed from the original content, falling back to a single tab character. Returns <code class="docutils literal notranslate"><span class="pre">this</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">options</span></code> argument can have an <code class="docutils literal notranslate"><span class="pre">exclude</span></code> property, which is an array of <code class="docutils literal notranslate"><span class="pre">[start,</span> <span class="pre">end]</span></code> character ranges. These ranges will be excluded from the indentation - useful for (e.g.) multiline strings.</p>
</section>
<section id="s-insertleft-index-content">
<h3>s.insertLeft( index, content )<a class="headerlink" href="#s-insertleft-index-content" title="Permalink to this headline">#</a></h3>
<p><strong>DEPRECATED</strong> since 0.17 – use <code class="docutils literal notranslate"><span class="pre">s.appendLeft(...)</span></code> instead</p>
</section>
<section id="s-insertright-index-content">
<h3>s.insertRight( index, content )<a class="headerlink" href="#s-insertright-index-content" title="Permalink to this headline">#</a></h3>
<p><strong>DEPRECATED</strong> since 0.17 – use <code class="docutils literal notranslate"><span class="pre">s.prependRight(...)</span></code> instead</p>
</section>
<section id="s-isempty">
<h3>s.isEmpty()<a class="headerlink" href="#s-isempty" title="Permalink to this headline">#</a></h3>
<p>Returns true if the resulting source is empty (disregarding white space).</p>
</section>
<section id="s-locate-index">
<h3>s.locate( index )<a class="headerlink" href="#s-locate-index" title="Permalink to this headline">#</a></h3>
<p><strong>DEPRECATED</strong> since 0.10 – see <a class="reference external" href="https://github.com/Rich-Harris/magic-string/pull/30">#30</a></p>
</section>
<section id="s-locateorigin-index">
<h3>s.locateOrigin( index )<a class="headerlink" href="#s-locateorigin-index" title="Permalink to this headline">#</a></h3>
<p><strong>DEPRECATED</strong> since 0.10 – see <a class="reference external" href="https://github.com/Rich-Harris/magic-string/pull/30">#30</a></p>
</section>
<section id="s-move-start-end-index">
<h3>s.move( start, end, index )<a class="headerlink" href="#s-move-start-end-index" title="Permalink to this headline">#</a></h3>
<p>Moves the characters from <code class="docutils literal notranslate"><span class="pre">start</span></code> and <code class="docutils literal notranslate"><span class="pre">end</span></code> to <code class="docutils literal notranslate"><span class="pre">index</span></code>. Returns <code class="docutils literal notranslate"><span class="pre">this</span></code>.</p>
</section>
<section id="s-overwrite-start-end-content-options">
<h3>s.overwrite( start, end, content[, options] )<a class="headerlink" href="#s-overwrite-start-end-content-options" title="Permalink to this headline">#</a></h3>
<p>Replaces the characters from <code class="docutils literal notranslate"><span class="pre">start</span></code> to <code class="docutils literal notranslate"><span class="pre">end</span></code> with <code class="docutils literal notranslate"><span class="pre">content</span></code>, along with the appended/prepended content in that range. The same restrictions as <code class="docutils literal notranslate"><span class="pre">s.remove()</span></code> apply. Returns <code class="docutils literal notranslate"><span class="pre">this</span></code>.</p>
<p>The fourth argument is optional. It can have a <code class="docutils literal notranslate"><span class="pre">storeName</span></code> property — if <code class="docutils literal notranslate"><span class="pre">true</span></code>, the original name will be stored for later inclusion in a sourcemap’s <code class="docutils literal notranslate"><span class="pre">names</span></code> array — and a <code class="docutils literal notranslate"><span class="pre">contentOnly</span></code> property which determines whether only the content is overwritten, or anything that was appended/prepended to the range as well.</p>
<p>It may be preferred to use <code class="docutils literal notranslate"><span class="pre">s.update(...)</span></code> instead if you wish to avoid overwriting the appended/prepended content.</p>
</section>
<section id="s-prepend-content">
<h3>s.prepend( content )<a class="headerlink" href="#s-prepend-content" title="Permalink to this headline">#</a></h3>
<p>Prepends the string with the specified content. Returns <code class="docutils literal notranslate"><span class="pre">this</span></code>.</p>
</section>
<section id="s-prependleft-index-content">
<h3>s.prependLeft ( index, content )<a class="headerlink" href="#s-prependleft-index-content" title="Permalink to this headline">#</a></h3>
<p>Same as <code class="docutils literal notranslate"><span class="pre">s.appendLeft(...)</span></code>, except that the inserted content will go <em>before</em> any previous appends or prepends at <code class="docutils literal notranslate"><span class="pre">index</span></code></p>
</section>
<section id="s-prependright-index-content">
<h3>s.prependRight ( index, content )<a class="headerlink" href="#s-prependright-index-content" title="Permalink to this headline">#</a></h3>
<p>Same as <code class="docutils literal notranslate"><span class="pre">s.appendRight(...)</span></code>, except that the inserted content will go <em>before</em> any previous appends or prepends at <code class="docutils literal notranslate"><span class="pre">index</span></code></p>
</section>
<section id="s-replace-regexporstring-substitution">
<h3>s.replace( regexpOrString, substitution )<a class="headerlink" href="#s-replace-regexporstring-substitution" title="Permalink to this headline">#</a></h3>
<p>String replacement with RegExp or string. When using a RegExp, replacer function is also supported. Returns <code class="docutils literal notranslate"><span class="pre">this</span></code>.</p>
<div class="highlight-ts notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nx">MagicString</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;magic-string&#39;</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">MagicString</span><span class="p">(</span><span class="nx">source</span><span class="p">)</span>

<span class="nx">s</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
<span class="nx">s</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/foo/g</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
<span class="nx">s</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/(\w)(\d+)/g</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">$1</span><span class="p">,</span><span class="w"> </span><span class="nx">$2</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">$1</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">$2</span><span class="p">)</span>
</pre></div>
</div>
<p>The differences from <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">String.replace</span></code></span>:</p>
<ul class="simple">
<li><p>It will always match against the <strong>original string</strong></p></li>
<li><p>It mutates the magic string state (use <code class="docutils literal notranslate"><span class="pre">.clone()</span></code> to be immutable)</p></li>
</ul>
</section>
<section id="s-replaceall-regexporstring-substitution">
<h3>s.replaceAll( regexpOrString, substitution )<a class="headerlink" href="#s-replaceall-regexporstring-substitution" title="Permalink to this headline">#</a></h3>
<p>Same as <code class="docutils literal notranslate"><span class="pre">s.replace</span></code>, but replace all matched strings instead of just one.
If <code class="docutils literal notranslate"><span class="pre">substitution</span></code> is a regex, then it must have the global (<code class="docutils literal notranslate"><span class="pre">g</span></code>) flag set, or a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code> is thrown. Matches the behavior of the bultin <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replaceAll"><code class="docutils literal notranslate"><span class="pre">String.property.replaceAll</span></code></a>.</p>
</section>
<section id="s-remove-start-end">
<h3>s.remove( start, end )<a class="headerlink" href="#s-remove-start-end" title="Permalink to this headline">#</a></h3>
<p>Removes the characters from <code class="docutils literal notranslate"><span class="pre">start</span></code> to <code class="docutils literal notranslate"><span class="pre">end</span></code> (of the original string, <strong>not</strong> the generated string). Removing the same content twice, or making removals that partially overlap, will cause an error. Returns <code class="docutils literal notranslate"><span class="pre">this</span></code>.</p>
</section>
<section id="s-slice-start-end">
<h3>s.slice( start, end )<a class="headerlink" href="#s-slice-start-end" title="Permalink to this headline">#</a></h3>
<p>Returns the content of the generated string that corresponds to the slice between <code class="docutils literal notranslate"><span class="pre">start</span></code> and <code class="docutils literal notranslate"><span class="pre">end</span></code> of the original string. Throws error if the indices are for characters that were already removed.</p>
</section>
<section id="s-snip-start-end">
<h3>s.snip( start, end )<a class="headerlink" href="#s-snip-start-end" title="Permalink to this headline">#</a></h3>
<p>Returns a clone of <code class="docutils literal notranslate"><span class="pre">s</span></code>, with all content before the <code class="docutils literal notranslate"><span class="pre">start</span></code> and <code class="docutils literal notranslate"><span class="pre">end</span></code> characters of the original string removed.</p>
</section>
<section id="s-tostring">
<h3>s.toString()<a class="headerlink" href="#s-tostring" title="Permalink to this headline">#</a></h3>
<p>Returns the generated string.</p>
</section>
<section id="s-trim-chartype">
<h3>s.trim([ charType ])<a class="headerlink" href="#s-trim-chartype" title="Permalink to this headline">#</a></h3>
<p>Trims content matching <code class="docutils literal notranslate"><span class="pre">charType</span></code> (defaults to <code class="docutils literal notranslate"><span class="pre">\s</span></code>, i.e. whitespace) from the start and end. Returns <code class="docutils literal notranslate"><span class="pre">this</span></code>.</p>
</section>
<section id="s-trimstart-chartype">
<h3>s.trimStart([ charType ])<a class="headerlink" href="#s-trimstart-chartype" title="Permalink to this headline">#</a></h3>
<p>Trims content matching <code class="docutils literal notranslate"><span class="pre">charType</span></code> (defaults to <code class="docutils literal notranslate"><span class="pre">\s</span></code>, i.e. whitespace) from the start. Returns <code class="docutils literal notranslate"><span class="pre">this</span></code>.</p>
</section>
<section id="s-trimend-chartype">
<h3>s.trimEnd([ charType ])<a class="headerlink" href="#s-trimend-chartype" title="Permalink to this headline">#</a></h3>
<p>Trims content matching <code class="docutils literal notranslate"><span class="pre">charType</span></code> (defaults to <code class="docutils literal notranslate"><span class="pre">\s</span></code>, i.e. whitespace) from the end. Returns <code class="docutils literal notranslate"><span class="pre">this</span></code>.</p>
</section>
<section id="s-trimlines">
<h3>s.trimLines()<a class="headerlink" href="#s-trimlines" title="Permalink to this headline">#</a></h3>
<p>Removes empty lines from the start and end. Returns <code class="docutils literal notranslate"><span class="pre">this</span></code>.</p>
</section>
<section id="s-update-start-end-content-options">
<h3>s.update( start, end, content[, options] )<a class="headerlink" href="#s-update-start-end-content-options" title="Permalink to this headline">#</a></h3>
<p>Replaces the characters from <code class="docutils literal notranslate"><span class="pre">start</span></code> to <code class="docutils literal notranslate"><span class="pre">end</span></code> with <code class="docutils literal notranslate"><span class="pre">content</span></code>. The same restrictions as <code class="docutils literal notranslate"><span class="pre">s.remove()</span></code> apply. Returns <code class="docutils literal notranslate"><span class="pre">this</span></code>.</p>
<p>The fourth argument is optional. It can have a <code class="docutils literal notranslate"><span class="pre">storeName</span></code> property — if <code class="docutils literal notranslate"><span class="pre">true</span></code>, the original name will be stored for later inclusion in a sourcemap’s <code class="docutils literal notranslate"><span class="pre">names</span></code> array — and an <code class="docutils literal notranslate"><span class="pre">overwrite</span></code> property which defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code> and determines whether anything that was appended/prepended to the range will be overwritten along with the original content.</p>
<p><code class="docutils literal notranslate"><span class="pre">s.update(start,</span> <span class="pre">end,</span> <span class="pre">content)</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">s.overwrite(start,</span> <span class="pre">end,</span> <span class="pre">content,</span> <span class="pre">{</span> <span class="pre">contentOnly:</span> <span class="pre">true</span> <span class="pre">})</span></code>.</p>
</section>
</section>
<section id="bundling">
<h2>Bundling<a class="headerlink" href="#bundling" title="Permalink to this headline">#</a></h2>
<p>To concatenate several sources, use <code class="docutils literal notranslate"><span class="pre">MagicString.Bundle</span></code>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">bundle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">MagicString</span><span class="p">.</span><span class="nx">Bundle</span><span class="p">();</span>

<span class="nx">bundle</span><span class="p">.</span><span class="nx">addSource</span><span class="p">({</span>
<span class="w">  </span><span class="nx">filename</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;foo.js&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">MagicString</span><span class="p">(</span><span class="s1">&#39;var answer = 42;&#39;</span><span class="p">)</span>
<span class="p">});</span>

<span class="nx">bundle</span><span class="p">.</span><span class="nx">addSource</span><span class="p">({</span>
<span class="w">  </span><span class="nx">filename</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;bar.js&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">MagicString</span><span class="p">(</span><span class="s1">&#39;console.log( answer )&#39;</span><span class="p">)</span>
<span class="p">});</span>

<span class="c1">// Sources can be marked as ignore-listed, which provides a hint to debuggers</span>
<span class="c1">// to not step into this code and also don&#39;t show the source files depending</span>
<span class="c1">// on user preferences.</span>
<span class="nx">bundle</span><span class="p">.</span><span class="nx">addSource</span><span class="p">({</span>
<span class="w">  </span><span class="nx">filename</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;some-3rdparty-library.js&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">MagicString</span><span class="p">(</span><span class="s1">&#39;function myLib(){}&#39;</span><span class="p">),</span>
<span class="w">  </span><span class="nx">ignoreList</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="c1">// &lt;--</span>
<span class="p">})</span>

<span class="c1">// Advanced: a source can include an `indentExclusionRanges` property</span>
<span class="c1">// alongside `filename` and `content`. This will be passed to `s.indent()`</span>
<span class="c1">// - see documentation above</span>

<span class="nx">bundle</span><span class="p">.</span><span class="nx">indent</span><span class="p">()</span><span class="w"> </span><span class="c1">// optionally, pass an indent string, otherwise it will be guessed</span>
<span class="w">  </span><span class="p">.</span><span class="nx">prepend</span><span class="p">(</span><span class="s1">&#39;(function () {\n&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;}());&#39;</span><span class="p">);</span>

<span class="nx">bundle</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
<span class="c1">// (function () {</span>
<span class="c1">//   var answer = 42;</span>
<span class="c1">//   console.log( answer );</span>
<span class="c1">// }());</span>

<span class="c1">// options are as per `s.generateMap()` above</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">bundle</span><span class="p">.</span><span class="nx">generateMap</span><span class="p">({</span>
<span class="w">  </span><span class="nx">file</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;bundle.js&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">includeContent</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nx">hires</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">});</span>
</pre></div>
</div>
<p>As an alternative syntax, if you a) don’t have <code class="docutils literal notranslate"><span class="pre">filename</span></code> or <code class="docutils literal notranslate"><span class="pre">indentExclusionRanges</span></code> options, or b) passed those in when you used <code class="docutils literal notranslate"><span class="pre">new</span> <span class="pre">MagicString(...)</span></code>, you can simply pass the <code class="docutils literal notranslate"><span class="pre">MagicString</span></code> instance itself:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">bundle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">MagicString</span><span class="p">.</span><span class="nx">Bundle</span><span class="p">();</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">MagicString</span><span class="p">(</span><span class="nx">someCode</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">filename</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;foo.js&#39;</span>
<span class="p">});</span>

<span class="nx">bundle</span><span class="p">.</span><span class="nx">addSource</span><span class="p">(</span><span class="nx">source</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="license">
<h2>License<a class="headerlink" href="#license" title="Permalink to this headline">#</a></h2>
<p>MIT</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./reveal/node_modules/magic-string"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Mark S. Baldwin<br/>
  
      &copy; Copyright 2023.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>